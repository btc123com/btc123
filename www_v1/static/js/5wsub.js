function PS(element){var doc=element.ownerDocument;var pos={"left":0,"top":0};var box;if(element.getBoundingClientRect){box = element.getBoundingClientRect();pos.left = Math.floor(box.left) + Math.max(doc.documentElement.scrollLeft, doc.body.scrollLeft);pos.top  = Math.floor(box.top)  + Math.max(doc.documentElement.scrollTop,  doc.body.scrollTop);pos.left -= doc.documentElement.clientLeft;pos.top  -= doc.documentElement.clientTop}return pos}var acIV='';$=function(id){return "string"==typeof id ? document.getElementById(id):id};function rmClass(o,n){o.className=o.className.replace(n,'')};function addClass(o,n){o.className+=' '+n};function hide(o){o.style.display='none'};function show(o){o.style.display='block'}var acBind=function(object,fun){return function(){return fun.apply(object,arguments)}};function AC(o,aO,t){this.o=$(o);this.aO=$(aO);this.s=t;this.index=-1;this.sV=""}AC.prototype={init:function(){if(document.all){p=PS(this.o);l=p.left;t=p.top+this.o.offsetHeight;}else{l=this.o.offsetLeft;t=this.o.offsetTop+this.o.offsetHeight;}this.aO.style.left=l+"px";this.aO.style.top=t+"px";this.aO.style.width= this.o.offsetWidth-2+"px"},hide:function(){while(this.aO.hasChildNodes()){this.aO.removeChild(this.aO.firstChild)}this.aO.className="auto_hidden"},setValue:function(_t){return function(){_t.o.value=this.seq;_t.aO.className="auto_hidden";document.forms['f'].submit()}},msover:function(_t,_d){return function(){_t.index=_d;var length=_t.aO.children.length;for(var j=0;j<length;j++){if(j!=_t.index){_t.aO.childNodes[j].className='auto_onmouseout';}else{_t.aO.childNodes[j].className='auto_onmouseover'}}}},cClass:function(l){for(var i=0;i<l;i++){if(i!=this.index){this.aO.childNodes[i].className='auto_onmouseout'}else{this.aO.childNodes[i].className='auto_onmouseover';this.o.value=this.aO.childNodes[i].seq}}},pressKey:function(event){var length=this.aO.children.length;if(event.keyCode==40){++this.index;if(this.index>length){this.index=0}else if(this.index==length){this.o.value=this.sV}this.cClass(length)}else if(event.keyCode==38){this.index--;if(this.index<-1){this.index=length-1}else if(this.index==-1){this.o.value=this.sV}this.cClass(length)}else if(event.keyCode==13){this.aO.className="auto_hidden";this.index=-1}else{this.index=-1}},start:function(event){if(event.keyCode!=13&&event.keyCode!=38&&event.keyCode!=40){this.init();this.hide();this.sV=this.o.value;if(this.o.value.replace(/(^\s*)|(\s*$)/g,'')==""){return;}acIV=this.o.value;if(this.s=='taobao')acLoadJS("http://suggest.taobao.com/sug?code=utf-8&callback=acCalla&q="+encodeURIComponent(this.o.value)+"&t="+Math.random());else acLoadJS("http://suggestion.baidu.com/su?wd="+encodeURIComponent(this.o.value)+"&ie=utf-8&cb=acCallb&t="+Math.random())}this.pressKey(event);window.onresize=acBind(this,function(){this.init();})}};function acShow(a){try{ var reg=new RegExp("("+acIV+")","i")}catch(e){return;}var div_index=0;for(var i=0;i<a.length;i++){if(typeof a[i]=='string'){w=a[i];n=''}else{w=a[i][0];n=a[i][1]}if(reg.test(w)){var div=document.createElement("div");div.className="auto_onmouseout";div.seq=w;div.onclick=ac.setValue(ac);div.onmouseover=ac.msover(ac,div_index);if(n)div.innerHTML='<li style="float:left">&nbsp;'+w.replace(reg,"<strong>$1</strong>")+'</li><li style="float:right;color:green">'+n+'&#26465;&#32467;&#26524;</li><br/>';else div.innerHTML='<li style="float:left">&nbsp;'+w.replace(reg,"<strong>$1</strong>")+'</li><br/>';ac.aO.appendChild(div);ac.aO.className="auto_show";div_index++}}};function acCalla(a){acShow(a.result)};function acCallb(a){acShow(a.s)};function acLoadJS(a,d){var c="tbsuggent",b=document.body.appendChild(document.createElement("script"));d="utf-8"||d;b.language="javascript";b.id=c;b.charset=d;b.src=a}var ac=new AC('kw','auto','baidu');document.onclick=function(){ac.hide()};var XMLHttp={_p:[],_i:function(){for(var i=0; i<this._p.length;i++){if(this._p[i].readyState==0 || this._p[i].readyState==4){return this._p[i];}}this._p[this._p.length]=this._cO();return this._p[this._p.length-1]},_cO:function(){if(window.XMLHttpRequest){var oX=new XMLHttpRequest()}else{var MSXML=['MSXML2.XMLHTTP.5.0','MSXML2.XMLHTTP.4.0','MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP','Microsoft.XMLHTTP'];for(var n=0;n<MSXML.length;n++){try{var oX=new ActiveXObject(MSXML[n]);break;}catch(e){}}}if(oX.readyState==null){oX.readyState=0;oX.addEventListener("load",function(){oX.readyState=4;if(typeof oX.onreadystatechange=="function"){oX.onreadystatechange();}},false);}return oX;},sendReq:function(method,u,data,cb){var oX=this._i();with(oX){try{if(u.indexOf("?")>0){u+="&randnum="+Math.random();}else{u+="?randnum="+Math.random()}open(method,u,true);setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=UTF-8');send(data);onreadystatechange=function(){if(oX.readyState==4 && (oX.status==200 || oX.status==304)){cb(oX)}}}catch(e){alert(e)}}}};function send_request(u,cb,data){if(typeof(data)=='undefined'){method='get'}else{method='post'}XMLHttp.sendReq(method,u,data,cb)}function getCookie(a){var b=a+"=";var c="";if(document.cookie.length>0){offset=document.cookie.lastIndexOf(b);if(offset!=-1){offset+=b.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}c=unescape(document.cookie.substring(offset,end))}}return c};function setHomePage(c,d){if(document.all){document.body.style.behavior="url(#default#homepage)";document.body.setHomePage(d)}else{if(window.sidebar){if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(b){alert("\u60a8\u7684firefox\u5b89\u5168\u9650\u5236\u9650\u5236\u60a8\u8fdb\u884c\u526a\u8d34\u677f\u64cd\u4f5c\uff0c\u8bf7\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165\u2019about:config\u2019\u5e76\u56de\u8f66\uff0c\u7136\u540e\u5c06\u2019signed.applets.codebase_principal_support\u2019\u8bbe\u7f6e\u4e3a\u2019true\u2019\u4e4b\u540e\u91cd\u8bd5\u3002");return}}var a=Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch);a.setCharPref("browser.startup.homepage",d)}}};function gotosearch(){var of=document.f;if(of.backurl !=undefined){var re;re=/{key}/g;var keys=of.key.value;var url=of.backurl.value;of.backurl.value=url.replace(re,keys);}return true;}var taobaof='';function neichange(f){if(null==$("kw"))var key=$("q").value;else var key=$("kw").value;var o=$('s_ul_detail').childNodes;for(var i=0;i<o.length;i++){if(o[i].nodeType == 1)rmClass(o[i],"cur");}addClass($("so_"+f),"cur");send_request('../getdata.php?act=getneisearch&sid='+f,function(json){eval('json='+json.responseText);var r,reg,inputid;reg=/taobao/ig;r=json.def.action.match(reg);if(r!=undefined){inputid='q';taobaof=f;}else{inputid='kw';};var str='';str+='<form name="f" action="'+json.def.action+'" method="get" onsubmit="return gotosearch();">';str+='<p><a href="'+json.def.url+'"><img src="../'+json.def.img_url+'" border="0"/></a>';str+='<input type="text" style="width:262px" class="int" onkeyup="ac.start(event)" autocomplete="off" name="'+json.def.name+'" id="'+inputid+'"/>';var i=json.i;for(var j=0;j<i;j++){str+='<input type="hidden" name="'+json.params[j][0]+'" value="'+json.params[j][1]+'"/>';}str+='<input type="submit" value="'+json.def.btn+'" id="bdbutton" class="searchint"></p></form>';$("sform_detail").innerHTML=str;getfocus(key,inputid);})};function getfocus(key,q){if(null==$(q))return;$(q).focus();$(q).value=key;if(q=='kw')t='baidu';else t='taobao';ac=new AC(q,'auto',t)};var mtimer=50,addsiteurl,addsitename,avC,hS=true,dI,hidem=function(){if(hS && avC){hide(avC)}};function mmover(el){hidem();var box=$("addmyfav");var w = el.offsetWidth+1;addsiteurl = el.href;addsitename= el.innerHTML;var o = PS(el);box.style.left=o.left+w+"px";box.style.top=o.top+"px";dI=window.setTimeout(function(){show(box)},mtimer);avC=box;hS=false;if(!box.onmouseover){box.onmouseover=function(){hS=false;box.href="http://www.5w.com/i/share.php?url="+addsiteurl+"&title="+addsitename;};box.onmouseout=function(){hS=true;window.setTimeout(hidem,mtimer)}}};function mmout(n){hS=true;window.setTimeout(hidem,mtimer);if(dI!=undefined){window.clearTimeout(dI)}};